<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <title>Brett Lernen – Multi-Sprachen Playground</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Brython für Python -->
  <script src="https://cdn.jsdelivr.net/npm/brython@3.11.0/brython.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/brython@3.11.0/brython_stdlib.js"></script>

  <!-- Fengari für Lua -->
  <script src="https://unpkg.com/fengari-web@0.1.4/dist/fengari-web.js"></script>

  <!-- Opal für Ruby -->
  <script src="https://cdn.opalrb.com/opal/current/opal.min.js"></script>
  <script src="https://cdn.opalrb.com/opal/current/opal-parser.min.js" onload="Opal.load('opal-parser')"></script>
  <script src="https://cdn.opalrb.com/opal/current/native.js"></script>

  <style>
    body { font-family: Arial, sans-serif; background: #f5f5f5; padding: 20px; }
    h1 { color: #ff7043; text-align: center; }
    h2 { color: #e64a19; margin-top: 40px; }
    textarea, pre.output {
      width: 100%;
      font-family: monospace;
      font-size: 1rem;
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 6px;
      resize: vertical;
      background: #fff;
      box-sizing: border-box;
      margin-top: 8px;
      min-height: 100px;
      white-space: pre-wrap;
    }
    button.run-button {
      margin-top: 10px;
      padding: 8px 20px;
      background: #ff7043;
      color: #fff;
      border: none;
      border-radius: 20px;
      cursor: pointer;
    }
    iframe {
      width: 100%;
      height: 200px;
      border: 1px solid #ccc;
      border-radius: 6px;
      margin-top: 10px;
    }
    .navbar {
      background-color: #333;
      overflow: hidden;
      display: flex;
      padding: 10px;
    }
  </style>
</head>
<body>

  <div class="navbar">
<img src="Alt/ICON_MAIN.png" alt="Beim Laden des Bildes ist ein Fehler aufgetreten." height="112" length="100"></img>
   <button class="styled-button" onclick="window.location.href='downloadcenter.html'">Downloadcenter</button>
    <button class="styled-button" onclick="window.location.href='Online-tools.html'">Onlinetools</button>
     <button class="styled-button" onclick="window.location.href='Brett_Lernen.html'">Multi-Sprachen-Editor</button>
    <button class="styled-button" onclick="window.location.href='Lizenz.html'">Lizenz</button>
     </div>

  <script>
    function loadPage(url) {
      document.getElementById('contentFrame').src = url;
    }
  </script>

</body>
<body onload="brython()">

  <h1>Brett Lernen – Multi-Sprachen Playground</h1>

  <!-- HTML -->
  <h2>HTML</h2>
  <textarea id="htmlCode"><h2>Hallo HTML!</h2><p>Dies ist ein HTML-Test.</p></textarea>
  <button class="run-button" onclick="document.getElementById('htmlOutput').srcdoc = document.getElementById('htmlCode').value;">▶ HTML anzeigen</button>
  <iframe id="htmlOutput"></iframe>

  <!-- JavaScript -->
  <h2>JavaScript</h2>
  <textarea id="jsCode">document.body.innerHTML = "<h2>Hallo von JavaScript!</h2><p>JS verändert das HTML.</p>";</textarea>
  <button class="run-button" onclick="runJS()">▶ JavaScript ausführen</button>
  <iframe id="jsOutput" sandbox="allow-scripts allow-same-origin"></iframe>

  <!-- Python -->
  <h2>Python (Brython)</h2>
  <textarea id="pyCode">for i in range(3):
    print(f"Python Zeile {i+1}")</textarea>
  <button class="run-button" id="runPythonBtn">▶ Python ausführen</button>
  <pre id="pyOutput" class="output">Ausgabe erscheint hier...</pre>

  <!-- Lua -->
  <h2>Lua (Fengari)</h2>
  <textarea id="luaCode">print("Hallo aus Lua!")
for i=1,3 do
  print("Lua Zeile "..i)
end
</textarea>
  <button class="run-button" onclick="runLua()">▶ Lua ausführen</button>
  <pre id="luaOutput" class="output">Ausgabe erscheint hier...</pre>

  <!-- Ruby -->
  <h2>Ruby (Opal)</h2>
  <textarea id="rbCode">require 'native'
output = Native(`document.getElementById("rbOutput")`)
output[:textContent] = ""
3.times do |i|
  output[:textContent] += "Ruby Zeile #{i+1}\n"
end</textarea>
  <button class="run-button" onclick="runRuby()">▶ Ruby ausführen</button>
  <pre id="rbOutput" class="output">Ausgabe erscheint hier...</pre>

  <!-- JavaScript-Ausführung -->
  <script>
    function runJS() {
      const code = document.getElementById('jsCode').value;
      const iframe = document.getElementById('jsOutput');
      iframe.srcdoc = `
        <html><body>
        <script>
        try {
          ${code}
        } catch(e) {
          document.body.innerHTML = '<pre style="color:red;">Fehler: ' + e + '</pre>';
        }
        <\/script>
        </body></html>
      `;
    }
  </script>

  <!-- Python-Ausführung -->
  <script type="text/python">
from browser import document
import sys
import io
import traceback

def run_python(ev):
    code = document["pyCode"].value
    output = document["pyOutput"]
    buffer = io.StringIO()
    sys.stdout = buffer
    sys.stderr = buffer

    try:
        exec(code, {})
    except Exception:
        buffer.write(traceback.format_exc())

    sys.stdout = sys.__stdout__
    sys.stderr = sys.__stderr__
    output.textContent = buffer.getvalue().strip() or "Keine Ausgabe."

document["runPythonBtn"].bind("click", run_python)
  </script>

  <!-- Lua-Ausführung mit Fengari -->
  <script>
    const { lua, lauxlib, lualib, to_luastring, to_jsstring } = fengari;

    function runLua() {
      const output = document.getElementById("luaOutput");
      output.textContent = "";

      // Neue Lua-VM für jede Ausführung, um sauber zu sein
      const L = lauxlib.luaL_newstate();
      lualib.luaL_openlibs(L);

      // JavaScript Funktion, die Lua 'print' ersetzen soll
      lua.lua_pushjsfunction(L, function(L) {
        let n = lua.lua_gettop(L);
        let texts = [];
        for(let i=1; i<=n; i++) {
          if(lua.lua_isstring(L, i)) {
            texts.push(to_jsstring(lua.lua_tolstring(L, i)));
          } else {
            texts.push(lua.lua_typename(L, lua.lua_type(L, i)));
          }
        }
        output.textContent += texts.join('\t') + '\n';
        return 0;
      });
      lua.lua_setglobal(L, to_luastring("print"));

      const code = document.getElementById("luaCode").value;

      // Lua-Code laden und ausführen
      const status = lauxlib.luaL_loadstring(L, to_luastring(code));
      if(status === lua.LUA_OK) {
        const callStatus = lua.lua_pcall(L, 0, lua.LUA_MULTRET, 0);
        if(callStatus !== lua.LUA_OK) {
          const msg = to_jsstring(lua.lua_tostring(L, -1));
          output.textContent += "LUA Fehler: " + msg;
        }
      } else {
        const msg = to_jsstring(lua.lua_tostring(L, -1));
        output.textContent = "LUA Lade-Fehler: " + msg;
      }
    }
  </script>

  <!-- Ruby-Ausführung mit Opal -->
  <script>
    function runRuby() {
      document.getElementById("rbOutput").textContent = "";
      try {
        Opal.eval(document.getElementById("rbCode").value);
      } catch (e) {
        document.getElementById("rbOutput").textContent = "Fehler: " + e.message;
      }
    }
  </script>

</body>
</html>

